{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#welcome-to-the-popcorn-guineapig-documentation","title":"Welcome to the Popcorn Guineapig documentation! \ud83d\udc4b","text":"<p>The goal of this plugin is to help enforce architectural rules in your multi-module project. Once you apply the plugin and specify your architecture guidelines, the plugin will automatically verify whether your architecture adheres to these rules.</p> <p>The Popcorn Gradle Plugin supports:</p> <ul> <li> <p>Kotlin Multiplatform Projects (KMP)</p> </li> <li> <p>Java Projects</p> </li> <li> <p>Android Projects</p> </li> </ul> <p>\u26a0\ufe0f Popcorn Guineapig plugin is designed for Gradle multi-module projects.</p> <p>Take a look at our repository.</p>"},{"location":"#summary","title":"Summary","text":""},{"location":"#1-getting-started","title":"1. Getting started","text":""},{"location":"#2-existing-rules","title":"2. Existing rules","text":""},{"location":"#3-custom-rules","title":"3. Custom rules","text":""},{"location":"#4-error-report","title":"4. Error report","text":""},{"location":"#5-contributions","title":"5. Contributions","text":""},{"location":"1-getting-started/","title":"Getting started \ud83d\ude80","text":""},{"location":"1-getting-started/#1-add-the-plugin-dependency","title":"1. Add the Plugin Dependency","text":"<p>Go to your build-logic folder, in the <code>build-logic/build.gradle.kts</code>, add the following dependency:</p> <pre><code>implementation(\"io.github.codandotv:popcornguineapig:&lt;version&gt;\")\n</code></pre>"},{"location":"1-getting-started/#2-apply-the-plugin","title":"2. Apply the Plugin","text":"<p>You have two ways to use PopcornGP in your project. In this section, we will present both options.</p> <p>Deprecated - Please use the parent plugin</p>"},{"location":"1-getting-started/#21-individual-plugin","title":"2.1. Individual plugin","text":"<p>You can chose a conventional gradle plugin to define your rules. </p> <p>For example, I have a gradle plugin applied to all data modules <code>data-setup-plugin.gradle.kts</code>. In this conventional plugin, you can add:</p> <pre><code>// build-logic/data-setup-plugin.gradle.kts\nplugins {\n  ...\n  id(\"io.github.codandotv.popcorngp\")\n}\n</code></pre>"},{"location":"1-getting-started/#configure-your-architecture-rules","title":"Configure Your Architecture Rules","text":"<p>Considering a data module, I want it to depend only on the domain module. This allows me to define it as follows:</p> <pre><code>// build-logic/data-setup-plugin.gradle.kts\npopcornGuineapigConfig {\n    // You also can skip rules to help duing migration\n    skippedRules = listOf(DoNotWithRule::class)\n\n    configuration = PopcornConfiguration(\n        project = PopcornProject(\n            type = ProjectType.JAVA\n        ),\n        rules = listOf(\n            NoDependencyRule(),\n            JustWithRule(\n                justWith = listOf(\"[a-z]+-domain\")\n            )\n        )\n    )\n}\n</code></pre>"},{"location":"1-getting-started/#run-the-task","title":"Run the task","text":"<pre><code>./gradlew popcorn\n</code></pre>"},{"location":"1-getting-started/#22-parent-plugin","title":"2.2. Parent plugin","text":"<p>Starting with version v3.1.0, we introduced support for a parent plugin, enabling developers to define all project rules in a centralized location.</p> <p>Let\u2019s create a plugin that will be applied to the root build.gradle file of our project:</p> <pre><code>// build-logic/popcorngp-setup-plugin.gradle.kts\nplugins {\n  ...\n  id(\"io.github.codandotv.popcorngpparent\")\n}\n</code></pre>"},{"location":"1-getting-started/#configure-all-your-architecture-rules","title":"Configure All Your Architecture Rules","text":"<p>Now, we can specify in a single place all the rules that we want to apply to our project.</p> <pre><code>// build-logic/popcorngp-setup-plugin.gradle.kts\npopcornGuineapigParentConfig {\n    type = ProjectType.KMP\n\n    children = listOf(\n        PopcornChildConfiguration(\n            moduleNameRegex = \":util:[a-z]+\",\n            rules = listOf(\n                NoDependencyRule(),\n            ),\n        ),\n        PopcornChildConfiguration(\n            moduleNameRegex = \":feature:[a-z]+\",\n            rules = listOf(\n                DoNotWithRule(\n                    notWith = listOf(\"data\"),\n                ),\n            ),\n        ),\n</code></pre> <p>Don\u2019t forget to apply the plugin to the root build.gradle file:</p> <pre><code>// root/build.gradle.kts\nplugins {\n    id(\"popcorngp-setup-plugin\")\n    ...\n}\n</code></pre>"},{"location":"1-getting-started/#run-the-task_1","title":"Run the task","text":"<pre><code>./gradlew popcornParent\n</code></pre> <p>It is simple as a popcorn \ud83c\udf7f + \ud83d\udc39</p> <p>Any problems you are facing, any suggestions you want to add, please feel free to reach us out.</p>"},{"location":"2-existing-rules/","title":"Existing rules \ud83d\udcd0","text":"<p>We have several rules already defined in the plugin. You can create some rule too, take a look in our section about contributions.</p>"},{"location":"2-existing-rules/#donotwithrule","title":"DoNotWithRule","text":"<p>The <code>DoNotWithRule</code> specifies that some modules should not depend on certain modules. For example:</p> <pre><code>popcornGuineapigParentConfig {\n    type = ProjectType.KMP\n\n    children = listOf(\n        PopcornChildConfiguration(\n            moduleNameRegex = \":feature:feature-[a-z]+\",\n            rules = listOf(\n                DoNotWithRule(\n                    notWith = listOf(\"[a-z]+-data\")\n                )\n            )\n        ),\n        ...\n    )\n}\n</code></pre> <p>In this case, any feature modules (<code>:feature:feature-dog</code>, <code>:feature:feature-guineapig</code>, and others) should not depend on any module whose name includes \u2018something-data\u2019 (e.g. <code>dog-data</code>, <code>guineapig-data</code>, and others).</p>"},{"location":"2-existing-rules/#justwithrule","title":"JustWithRule","text":"<p>The <code>JustWithRule</code> specifies that some modules should depend on certain modules. For example:</p> <pre><code>popcornGuineapigParentConfig {\n    type = ProjectType.KMP\n\n    children = listOf(\n        ...\n        PopcornChildConfiguration(\n            moduleNameRegex = \":[a-z]+:data\",\n            rules = listOf(\n                JustWithRule(\n                    justWith = listOf(\"domain\")\n                )\n            )\n        )\n        ...\n    )\n}\n</code></pre> <p>In this case, all data modules (e.g. <code>:car:data</code>, <code>:rent:data</code>, and others) should depend only on a domain module.</p>"},{"location":"2-existing-rules/#nodependencyrule","title":"NoDependencyRule","text":"<p>The <code>NoDependencyRule</code> ensures that some modules remains free of any dependencies. For example:</p> <pre><code>popcornGuineapigParentConfig {\n    type = ProjectType.KMP\n\n    children = listOf(\n        ...\n        PopcornChildConfiguration(\n            moduleNameRegex = \":util:[a-z]+\",\n            rules = listOf(\n                NoDependencyRule(),\n            ),\n        ),\n        ...\n    )\n}\n</code></pre> <p>In this case, all util modules (e.g. <code>:util:media</code>, <code>:util:camera</code>, and others) should be free of any dependencies.</p>"},{"location":"2-existing-rules/#popcornguineapigrule","title":"PopcornGuineaPigRule","text":"<p>Take a look in our documentation about how you can create your custom rule.</p>"},{"location":"3-custom-rules/","title":"Custom rules \ud83d\udcdd","text":""},{"location":"3-custom-rules/#create-your-rule","title":"Create your rule","text":"<p>You also can create custom rules:</p> <pre><code>class MyRule : PopcornGuineaPigRule {\n    override fun check(deps: List&lt;InternalDependenciesMetadata&gt;): ArchitectureViolationError? {\n        return null\n    }\n}\n</code></pre>"},{"location":"3-custom-rules/#register-your-rule","title":"Register your rule","text":"<p>After that, you just need to register in the set of rules:</p> <pre><code>popcornGuineapigParentConfig {\n    type = ProjectType.KMP\n\n    children = listOf(\n        ...\n        PopcornChildConfiguration(\n            moduleNameRegex = \":target-module\",\n            rules = listOf(\n                 MyRule(),\n            )\n        )\n}\n</code></pre>"},{"location":"4-error-report/","title":"Error reports \ud83d\udcc3","text":"<p>Error reports available &gt;= 3.0.0</p> <p>Starting from version <code>3.0.0</code>, you can enable error report generation in your project.</p> <p>To enable this feature, you need to run the popcorn task:</p> <p>Deprecated - Please use the parent plugin</p> <pre><code>./gradlew popcorn -PerrorReportEnabled\n</code></pre> <p>or</p> <pre><code>./gradlew popcornParent -PerrorReportEnabled\n</code></pre> <p>After you run the task, you can see a new report at <code>/yourproject/yourmodule/build/reports/popcornguineapig/errorReport.md</code>.</p> <p>This report offers a comprehensive analysis of the errors detected in your module.</p>"},{"location":"5-contributions/","title":"Contributions \ud83e\udd1d","text":"<p>We encourage contributions of all types! Whether it\u2019s reporting issues, suggesting new features, or submitting pull requests, you\u2019re welcome to help improve the plugin.</p> <ul> <li>Check out the issues page for ideas.</li> <li>Feel free to submit pull requests.</li> </ul>"},{"location":"5-contributions/#how-to-test-the-popcorngp-locally-in-a-project","title":"How to test the popcorngp locally in a project?","text":""},{"location":"5-contributions/#publishing-the-library-locally","title":"Publishing the library locally","text":"<p>Use JVM 17</p> <p>Make sure your Gradle is using JVM 17, otherwise you could have some issues.</p> <p>To run the plugin locally you need to publish it in your local machine using <code>mavenLocal</code>.  You can follow the steps:</p> <p>1- Update the <code>popcornguineapigplugin/build.gradle.kts</code> commenting the lines:</p> <pre><code>...\nmavenPublishing {\n    //publishToMavenCentral(SonatypeHost.CENTRAL_PORTAL)\n    //signAllPublications()\n    ...\n</code></pre> <p>2- Publish the plugin locally, using the command:</p> <pre><code>./gradlew :popcornguineapigplugin:publishToMavenLocal\n</code></pre> <p>After that, the plugin artifacts will be in your machine in the following path  <code>$HOME/.m2/repository/io/github/codandotv/popcornguineapig/x.x.x</code>.</p>"},{"location":"5-contributions/#using-the-local-library-in-any-project","title":"Using the local library in any project","text":"<p>1- In your project, you can use by adding the <code>mavenLocal()</code> repository in the following places:</p> <pre><code>// settings.gradle.kts\npluginManagement {\n    ...\n    repositories {\n        ...\n        mavenLocal()\n    }\n}\n</code></pre> <pre><code>// build-logic/build.gradle.kts\n...\nrepositories {\n    mavenLocal()\n    // ...\n}\n\ndependencies {\n    implementation(\"io.github.codandotv:popcornguineapig:x.x.x\")\n}\n</code></pre>"},{"location":"5-contributions/#how-to-run-the-documentation-locally","title":"How to run the documentation locally?","text":"<ul> <li>Create your virtual env:</li> </ul> <pre><code>python3 -m venv venv\n</code></pre> <ul> <li>Open the new env:</li> </ul> <pre><code>source venv/bin/activate\n</code></pre> <ul> <li>Install mkdocs-material:</li> </ul> <pre><code>pip install mkdocs-material\n</code></pre> <ul> <li>Start the local server:</li> </ul> <pre><code>mkdocs serve --watch .\n</code></pre> <p>Access your documentation at <code>http://127.0.0.1:8000/</code></p>"},{"location":"5-contributions/#some-tips","title":"Some tips","text":"<ul> <li> <p>We primarily use IntelliJ IDEA for developing new features and fixing bugs. While it\u2019s possible to use Android Studio, IntelliJ IDEA is the more convenient option, especially since we are working on a Gradle plugin;</p> </li> <li> <p>When developing a new architecture rule, make sure to write unit tests for it. Additionally, you can create a sample in the sample directory to simulate the architecture violation;</p> </li> <li> <p>If you have any questions about contributions, feel free to reach out to someone from CodandoTV. You can contact Gabriel Moro or Rodrigo Vianna.</p> </li> </ul> <p>\ud83e\udd17 Happy coding!</p>"}]}